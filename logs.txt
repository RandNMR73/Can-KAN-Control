20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 14.529267072677612
kan
0 reward: -13.511
1 reward: -15.231
2 reward: -11.980
3 reward: -17.150
4 reward: -20.146
5 reward: -15.564
6 reward: -20.463
7 reward: -17.234
8 reward: -19.186
9 reward: -18.896
mlp
0 reward: -87.790
1 reward: -87.392
2 reward: -93.026
3 reward: -58.736
4 reward: -44.664
5 reward: -81.971
6 reward: -71.776
7 reward: -61.635
8 reward: -54.703
9 reward: -70.213
equation 79
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 261.4759752750397
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 20.655506134033203
kan
0 reward: -11.365
1 reward: -7.014
2 reward: -7.737
3 reward: -9.774
4 reward: -11.371
5 reward: -6.928
6 reward: -7.265
7 reward: -11.356
8 reward: -6.471
9 reward: -8.445
mlp
0 reward: -10.379
1 reward: -20.191
2 reward: -17.260
3 reward: -14.481
4 reward: -12.337
5 reward: -10.803
6 reward: -10.174
7 reward: -13.133
8 reward: -12.328
9 reward: -47.224
equation 80
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 261.62915873527527
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 21.4892840385437
kan
0 reward: -4.446
1 reward: -6.035
2 reward: -6.252
3 reward: -5.492
4 reward: -3.982
5 reward: -4.855
6 reward: -5.298
7 reward: -4.804
8 reward: -4.291
9 reward: -7.744
mlp
0 reward: -6.810
1 reward: -9.159
2 reward: -8.708
3 reward: -7.904
4 reward: -7.955
5 reward: -7.248
6 reward: -7.266
7 reward: -7.557
8 reward: -7.112
9 reward: -11.349
equation 81
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 261.5859680175781
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 20.29558515548706
kan
0 reward: -5.288
1 reward: -8.764
2 reward: -4.884
3 reward: -7.792
4 reward: -6.017
5 reward: -5.847
6 reward: -4.538
7 reward: -5.934
8 reward: -5.461
9 reward: -7.448
mlp
0 reward: -8.665
1 reward: -10.618
2 reward: -11.285
3 reward: -8.826
4 reward: -8.193
5 reward: -8.087
6 reward: -9.860
7 reward: -8.647
8 reward: -8.790
9 reward: -10.405
equation 82
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 276.97732400894165
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 27.94152593612671
kan
0 reward: -12.714
1 reward: -15.267
2 reward: -14.200
3 reward: -15.119
4 reward: -12.989
5 reward: -12.152
6 reward: -13.119
7 reward: -9.475
8 reward: -10.549
9 reward: -14.154
mlp
0 reward: -14.453
1 reward: -14.982
2 reward: -13.406
3 reward: -11.707
4 reward: -13.365
5 reward: -13.426
6 reward: -11.939
7 reward: -19.876
8 reward: -16.349
9 reward: -12.393
equation 83
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 251.6172800064087
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 15.310054063796997
kan
0 reward: -1.063
1 reward: -2.644
2 reward: -1.611
3 reward: -4.598
4 reward: -5.297
5 reward: -2.188
6 reward: -2.881
7 reward: -4.686
8 reward: -4.496
9 reward: -4.413
mlp
0 reward: -5.385
1 reward: -7.188
2 reward: -6.096
3 reward: -8.465
4 reward: -10.823
5 reward: -7.262
6 reward: -7.901
7 reward: -7.804
8 reward: -9.525
9 reward: -8.418
equation 84
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 259.8710289001465
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 17.00470781326294
kan
0 reward: -6.304
1 reward: -6.665
2 reward: -9.909
3 reward: -23.308
4 reward: -10.273
5 reward: -6.431
6 reward: -5.908
7 reward: -5.701
8 reward: -5.236
9 reward: -8.950
mlp
0 reward: -9.977
1 reward: -6.647
2 reward: -8.383
3 reward: -7.795
4 reward: -4.793
5 reward: -6.852
6 reward: -8.374
7 reward: -8.891
8 reward: -6.399
9 reward: -6.600
equation 85
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 244.57294178009033
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 12.324708938598633
kan
0 reward: -2.508
1 reward: -1.864
2 reward: -2.024
3 reward: -2.090
4 reward: -2.453
5 reward: -1.885
6 reward: -2.544
7 reward: -2.275
8 reward: -1.524
9 reward: -2.390
mlp
0 reward: -3.014
1 reward: -1.946
2 reward: -2.850
3 reward: -4.979
4 reward: -3.382
5 reward: -3.164
6 reward: -5.108
7 reward: -5.420
8 reward: -4.879
9 reward: -4.457
equation 86
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 258.0008409023285
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 18.39065909385681
kan
0 reward: -6.671
1 reward: -7.922
2 reward: -2.286
3 reward: -3.632
4 reward: -5.469
5 reward: -7.182
6 reward: -5.266
7 reward: -8.995
8 reward: -9.259
9 reward: -2.854
mlp
0 reward: -9.141
1 reward: -9.263
2 reward: -10.926
3 reward: -9.066
4 reward: -11.237
5 reward: -9.086
6 reward: -6.397
7 reward: -8.957
8 reward: -5.516
9 reward: -12.859
equation 87
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 259.41378593444824
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 17.4545841217041
kan
0 reward: -12.934
1 reward: -6.846
2 reward: -8.839
3 reward: -8.409
4 reward: -6.014
5 reward: -7.860
6 reward: -7.222
7 reward: -10.217
8 reward: -5.779
9 reward: -9.006
mlp
0 reward: -6.605
1 reward: -8.491
2 reward: -8.621
3 reward: -7.875
4 reward: -9.591
5 reward: -6.275
6 reward: -4.744
7 reward: -6.991
8 reward: -5.590
9 reward: -12.230
equation 88
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 254.00647616386414
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 14.50443410873413
kan
0 reward: -6.045
1 reward: -7.172
2 reward: -6.630
3 reward: -6.606
4 reward: -7.059
5 reward: -6.866
6 reward: -7.179
7 reward: -7.299
8 reward: -7.706
9 reward: -6.998
mlp
0 reward: -9.453
1 reward: -10.223
2 reward: -9.739
3 reward: -8.911
4 reward: -7.973
5 reward: -10.078
6 reward: -9.190
7 reward: -9.155
8 reward: -9.589
9 reward: -9.123
equation 89
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 247.43318510055542
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 14.643663167953491
kan
0 reward: -5.721
1 reward: -5.321
2 reward: -5.284
3 reward: -7.856
4 reward: -8.948
5 reward: -7.013
6 reward: -8.140
7 reward: -7.660
8 reward: -8.622
9 reward: -8.251
mlp
0 reward: -5.781
1 reward: -11.969
2 reward: -7.976
3 reward: -17.552
4 reward: -18.347
5 reward: -9.180
6 reward: -13.501
7 reward: -15.266
8 reward: -16.059
9 reward: -18.018
equation 90
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 271.47816276550293
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 22.880981922149658
kan
0 reward: -11.495
1 reward: -10.561
2 reward: -9.122
3 reward: -10.648
4 reward: -13.164
5 reward: -10.502
6 reward: -12.457
7 reward: -9.268
8 reward: -7.986
9 reward: -12.051
mlp
0 reward: nan
1 reward: nan
2 reward: nan
3 reward: nan
4 reward: nan
5 reward: nan
6 reward: nan
7 reward: nan
8 reward: nan
9 reward: nan
equation 91
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 255.63283801078796
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 17.734128713607788
kan
0 reward: -2.470
1 reward: -3.118
2 reward: -3.601
3 reward: -3.817
4 reward: -5.072
5 reward: -3.806
6 reward: -2.549
7 reward: -3.404
8 reward: -3.122
9 reward: -4.605
mlp
0 reward: -4.359
1 reward: -6.469
2 reward: -9.994
3 reward: -7.373
4 reward: -6.768
5 reward: -5.760
6 reward: -4.062
7 reward: -4.255
8 reward: -4.004
9 reward: -14.380
equation 92
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 243.65412974357605
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 12.037023067474365
kan
0 reward: -1.243
1 reward: -1.643
2 reward: -1.540
3 reward: -0.989
4 reward: -1.705
5 reward: -0.938
6 reward: -2.030
7 reward: -1.930
8 reward: -0.661
9 reward: -1.572
mlp
0 reward: -1.469
1 reward: -2.363
2 reward: -2.055
3 reward: -1.169
4 reward: -2.068
5 reward: -1.434
6 reward: -2.366
7 reward: -2.014
8 reward: -0.790
9 reward: -1.752
equation 93
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 257.4375510215759
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 17.84197473526001
kan
0 reward: -6.016
1 reward: -3.605
2 reward: -5.085
3 reward: -5.049
4 reward: -4.456
5 reward: -3.455
6 reward: -4.740
7 reward: -4.219
8 reward: -3.335
9 reward: -4.989
mlp
0 reward: -3.311
1 reward: -4.832
2 reward: -4.652
3 reward: -5.191
4 reward: -5.341
5 reward: -3.221
6 reward: -3.848
7 reward: -3.423
8 reward: -3.955
9 reward: -7.114
equation 94
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 261.80602073669434
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 19.81769895553589
kan
0 reward: -3.159
1 reward: -18.345
2 reward: -13.198
3 reward: -11.511
4 reward: -4.676
5 reward: -7.394
6 reward: -8.224
7 reward: -4.841
8 reward: -4.481
9 reward: -24.614
mlp
0 reward: -19.838
1 reward: -36.233
2 reward: -30.910
3 reward: -29.720
4 reward: -22.120
5 reward: -26.196
6 reward: -27.273
7 reward: -22.253
8 reward: -23.693
9 reward: -36.638
equation 95
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 250.94927740097046
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 14.587772846221924
kan
0 reward: -3.366
1 reward: -2.690
2 reward: -2.180
3 reward: -2.568
4 reward: -3.429
5 reward: -2.209
6 reward: -2.577
7 reward: -3.199
8 reward: -3.771
9 reward: -2.780
mlp
0 reward: -3.051
1 reward: -2.987
2 reward: -3.309
3 reward: -4.386
4 reward: -3.254
5 reward: -2.661
6 reward: -2.742
7 reward: -4.093
8 reward: -4.306
9 reward: -3.441
equation 96
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 251.76547479629517
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 14.335975885391235
kan
0 reward: -6.470
1 reward: -7.508
2 reward: -6.078
3 reward: -7.827
4 reward: -8.807
5 reward: -7.162
6 reward: -7.937
7 reward: -8.037
8 reward: -7.669
9 reward: -7.698
mlp
0 reward: -3.406
1 reward: -5.465
2 reward: -4.343
3 reward: -8.882
4 reward: -9.748
5 reward: -3.752
6 reward: -5.922
7 reward: -9.498
8 reward: -8.502
9 reward: -7.256
equation 97
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 251.2961688041687
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 14.671706914901733
kan
0 reward: -2.875
1 reward: -3.164
2 reward: -3.160
3 reward: -8.045
4 reward: -10.253
5 reward: -2.453
6 reward: -3.258
7 reward: -12.101
8 reward: -10.769
9 reward: -4.285
mlp
0 reward: -3.406
1 reward: -3.842
2 reward: -3.897
3 reward: -6.515
4 reward: -6.382
5 reward: -2.732
6 reward: -3.315
7 reward: -8.034
8 reward: -7.439
9 reward: -4.845
equation 98
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 251.3799068927765
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 15.447819948196411
kan
0 reward: -7.065
1 reward: -10.423
2 reward: -8.548
3 reward: -28.040
4 reward: -37.653
5 reward: -9.190
6 reward: -13.937
7 reward: -33.489
8 reward: -33.690
9 reward: -17.872
mlp
0 reward: -8.206
1 reward: -9.339
2 reward: -8.699
3 reward: -21.721
4 reward: -36.536
5 reward: -8.046
6 reward: -10.919
7 reward: -37.151
8 reward: -32.155
9 reward: -14.163
equation 99
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 262.2716326713562
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 20.62446427345276
kan
0 reward: -564.027
1 reward: -154.632
2 reward: -266.614
3 reward: -366.099
4 reward: -561.233
5 reward: -444.696
6 reward: -361.152
7 reward: -573.485
8 reward: -542.875
9 reward: -75.775
mlp
0 reward: -544.204
1 reward: -135.080
2 reward: -250.314
3 reward: -344.160
4 reward: -547.620
5 reward: -416.962
6 reward: -338.436
7 reward: -554.295
8 reward: -517.367
9 reward: -61.822
equation 100
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 258.92673897743225
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 17.040505170822144
kan
0 reward: -5.253
1 reward: -7.715
2 reward: -5.248
3 reward: -6.658
4 reward: -8.568
5 reward: -7.170
6 reward: -6.953
7 reward: -7.246
8 reward: -9.211
9 reward: -7.118
mlp
0 reward: -6.324
1 reward: -5.045
2 reward: -4.646
3 reward: -4.662
4 reward: -6.804
5 reward: -10.786
6 reward: -4.991
7 reward: -5.083
8 reward: -4.790
9 reward: -4.748
equation 101
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 278.1752619743347
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 26.684367895126343
kan
0 reward: -843.049
1 reward: -478.405
2 reward: -440.760
3 reward: -607.393
4 reward: -535.565
5 reward: -638.128
6 reward: -536.590
7 reward: -841.106
8 reward: -799.968
9 reward: -667.151
mlp
0 reward: -843.049
1 reward: -478.405
2 reward: -440.760
3 reward: -607.393
4 reward: -535.565
5 reward: -638.128
6 reward: -536.590
7 reward: -841.106
8 reward: -799.968
9 reward: -667.151
equation 102
Traceback (most recent call last):
  File "/Users/jameschen/Documents/Can-KAN-Control/feynman_report.py", line 141, in <module>
    main()
  File "/Users/jameschen/Documents/Can-KAN-Control/feynman_report.py", line 101, in main
    kan_model, kan_hist = train_model(eq_num, 'kan', hidden_size, max_evals, env_bs, train_seed)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jameschen/Documents/Can-KAN-Control/feynman_report.py", line 36, in train_model
    env = CartLatAccelEnv(noise_mode=None, env_bs=env_bs, eq=eq_num)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jameschen/Documents/Can-KAN-Control/gym_cartlataccel/env.py", line 54, in __init__
    self.obs_high = np.stack([np.array(self.high + list(self.max_x)) for _ in range(self.bs)])
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jameschen/Library/Python/3.12/lib/python/site-packages/gymnasium/spaces/box.py", line 162, in __init__
    raise ValueError(
ValueError: Box all low values must be less than or equal to high (some values break this), low=[[1.        1.        0.        0.        1.        2.8997517
]
 [1.        1.        0.        0.        1.        2.8997517]
 [1.        1.        0.        0.        1.        2.8997517]
 ...
 [1.        1.        0.        0.        1.        2.8997517]
 [1.        1.        0.        0.        1.        2.8997517]
 [1.        1.        0.        0.        1.        2.8997517]], high=[[2. 2. 1. 1. 2. 2.]
 [2. 2. 1. 1. 2. 2.]
 [2. 2. 1. 1. 2. 2.]
 ...
 [2. 2. 1. 1. 2. 2.]
 [2. 2. 1. 1. 2. 2.]
 [2. 2. 1. 1. 2. 2.]]
(kan) jameschen@Jamess-MacBook-Pro-4 Can-KAN-Control % python3 feynman_report.py
equation 103
Traceback (most recent call last):
  File "/Users/jameschen/Documents/Can-KAN-Control/feynman_report.py", line 141, in <module>
    main()
  File "/Users/jameschen/Documents/Can-KAN-Control/feynman_report.py", line 101, in main
    kan_model, kan_hist = train_model(eq_num, 'kan', hidden_size, max_evals, env_bs, train_seed)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jameschen/Documents/Can-KAN-Control/feynman_report.py", line 53, in train_model
    ppo = PPO(env, model, env_bs=env_bs, device=device, seed=seed, debug=False)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jameschen/Documents/Can-KAN-Control/ppo_kan.py", line 36, in __init__
    self.seed_env()
  File "/Users/jameschen/Documents/Can-KAN-Control/ppo_kan.py", line 45, in seed_env
    self.env.reset(seed=self.seed)
  File "/Users/jameschen/Documents/Can-KAN-Control/gym_cartlataccel/env.py", line 113, in reset
    self.x_targets = self.generate_traj(self.bs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jameschen/Documents/Can-KAN-Control/gym_cartlataccel/env.py", line 98, in generate_traj
    scaled_traj = self.min_x + (traj - row_min) * (self.max_x - self.min_x) / (row_max - row_min)
                               ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~
ValueError: operands could not be broadcast together with shapes (1000,500,2) (10000,)
(kan) jameschen@Jamess-MacBook-Pro-4 Can-KAN-Control % git checkout ikan
M       feynman_report.py
M       results/feynman_results.txt
Switched to branch 'ikan'
(kan) jameschen@Jamess-MacBook-Pro-4 Can-KAN-Control % python3 feynman_report.py
equation 103
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 429.3813180923462
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 26.410733938217163
kan
0 reward: -3.453
1 reward: -4.513
2 reward: -5.340
3 reward: -5.333
4 reward: -6.031
5 reward: -5.184
6 reward: -4.313
7 reward: -5.080
8 reward: -5.385
9 reward: -5.435
mlp
0 reward: -4.125
1 reward: -6.339
2 reward: -4.669
3 reward: -6.406
4 reward: -4.609
5 reward: -5.489
6 reward: -5.659
7 reward: -5.971
8 reward: -6.978
9 reward: -6.341
2024-12-05 16:11:06.547 Python[62001:21224042] ApplePersistenceIgnoreState: Existing state will not be touched. New state will be written to /var/folders/nl/
ss4rd5tx78dfyyx_vww_fq040000gn/T/org.python.python.savedState
equation 104
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 1233.6363439559937
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 130.68779683113098
kan
0 reward: -560.455
1 reward: -147.770
2 reward: -261.879
3 reward: -360.548
4 reward: -558.130
5 reward: -433.686
6 reward: -357.037
7 reward: -566.586
8 reward: -534.827
9 reward: -67.872
mlp
0 reward: -560.879
1 reward: -148.073
2 reward: -262.245
3 reward: -360.929
4 reward: -558.491
5 reward: -434.063
6 reward: -357.402
7 reward: -566.982
8 reward: -535.216
9 reward: -68.185
equation 105
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 1186.050095796585
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 99.19659805297852
kan
0 reward: -3.660
1 reward: -3.374
2 reward: -4.334
3 reward: -3.683
4 reward: -3.417
5 reward: -3.052
6 reward: -3.164
7 reward: -4.051
8 reward: -3.212
9 reward: -3.664
mlp
0 reward: -6.196
1 reward: -5.693
2 reward: -7.263
3 reward: -5.954
4 reward: -5.673
5 reward: -5.842
6 reward: -4.594
7 reward: -6.924
8 reward: -6.081
9 reward: -5.517
equation 106
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 1111.987186908722
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 113.79103302955627
kan
0 reward: -3.037
1 reward: -1.895
2 reward: -2.635
3 reward: -2.702
4 reward: -2.730
5 reward: -2.987
6 reward: -1.540
7 reward: -3.723
8 reward: -1.763
9 reward: -2.770
mlp
0 reward: -14.161
1 reward: -13.204
2 reward: -18.587
3 reward: -16.079
4 reward: -16.041
5 reward: -12.518
6 reward: -11.811
7 reward: -12.859
8 reward: -10.066
9 reward: -18.157
equation 107
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 1126.545217037201
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 87.25153684616089
kan
0 reward: -19.945
1 reward: -18.471
2 reward: -20.093
3 reward: -17.285
4 reward: -21.836
5 reward: -18.519
6 reward: -19.885
7 reward: -19.193
8 reward: -17.892
9 reward: -19.760
mlp
0 reward: -10.914
1 reward: -38.097
2 reward: -25.849
3 reward: -23.046
4 reward: -13.749
5 reward: -14.116
6 reward: -12.186
7 reward: -16.347
8 reward: -11.703
9 reward: -53.277
equation 108
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 1200.859081029892
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 135.88288688659668
kan
0 reward: -194.796
1 reward: -174.143
2 reward: -107.859
3 reward: -117.535
4 reward: -182.218
5 reward: -145.449
6 reward: -212.310
7 reward: -161.404
8 reward: -269.997
9 reward: -70.376
mlp
0 reward: -35.326
1 reward: -41.559
2 reward: -28.863
3 reward: -34.143
4 reward: -26.156
5 reward: -26.489
6 reward: -59.250
7 reward: -36.691
8 reward: -65.850
9 reward: -28.562
equation 109
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 1327.6390779018402
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 116.30136775970459
kan
0 reward: -70.855
1 reward: -108.315
2 reward: -179.886
3 reward: -133.189
4 reward: -188.649
5 reward: -73.533
6 reward: -60.755
7 reward: -50.955
8 reward: -46.245
9 reward: -235.439
mlp
0 reward: -46.507
1 reward: -43.718
2 reward: -61.539
3 reward: -53.188
4 reward: -55.509
5 reward: -28.431
6 reward: -30.063
7 reward: -36.223
8 reward: -22.295
9 reward: -79.036
equation 110
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 1114.9154660701752
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 115.1452271938324
kan
0 reward: -3.702
1 reward: -3.584
2 reward: -5.135
3 reward: -4.128
4 reward: -4.464
5 reward: -2.665
6 reward: -1.754
7 reward: -3.195
8 reward: -1.748
9 reward: -6.840
mlp
0 reward: -9.798
1 reward: -12.070
2 reward: -12.987
3 reward: -11.901
4 reward: -12.231
5 reward: -8.950
6 reward: -10.174
7 reward: -9.494
8 reward: -9.938
9 reward: -15.675
equation 111
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 1464.0183520317078
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 177.5250289440155
kan
0 reward: -838.550
1 reward: -474.178
2 reward: -436.601
3 reward: -603.113
4 reward: -531.394
5 reward: -633.656
6 reward: -532.148
7 reward: -836.637
8 reward: -795.473
9 reward: -662.703
mlp
0 reward: -838.558
1 reward: -474.182
2 reward: -436.605
3 reward: -603.119
4 reward: -531.399
5 reward: -633.662
6 reward: -532.153
7 reward: -836.644
8 reward: -795.480
9 reward: -662.709
equation 112
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 693.9250721931458
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 22.641932010650635
kan
0 reward: -5.373
1 reward: -6.320
2 reward: -7.356
3 reward: -7.914
4 reward: -6.541
5 reward: -11.794
6 reward: -10.019
7 reward: -8.845
8 reward: -4.841
9 reward: -6.976
mlp
0 reward: -4.359
1 reward: -4.085
2 reward: -6.022
3 reward: -4.423
4 reward: -5.865
5 reward: -5.313
6 reward: -6.226
7 reward: -5.504
8 reward: -4.284
9 reward: -5.696
/Users/jameschen/Documents/Can-KAN-Control/feynman_report.py:10: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot in
terface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.
max_open_warning`). Consider using `matplotlib.pyplot.close()`.

equation 113
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 276.91912722587585
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 24.35378885269165
kan
0 reward: -33.794
1 reward: -13.056
2 reward: -29.018
3 reward: -4.748
4 reward: -8.475
5 reward: -6.942
6 reward: -4.696
7 reward: -24.907
8 reward: -5.359
9 reward: -58.744
mlp
0 reward: -109.616
1 reward: -69.182
2 reward: -108.190
3 reward: -88.665
4 reward: -68.469
5 reward: -88.887
6 reward: -117.593
7 reward: -84.119
8 reward: -45.667
9 reward: -144.940
/Users/jameschen/Documents/Can-KAN-Control/feynman_report.py:9: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot int
erface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.m
ax_open_warning`). Consider using `matplotlib.pyplot.close()`.
  fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(10, 8))
equation 114
Traceback (most recent call last):
  File "/Users/jameschen/Documents/Can-KAN-Control/feynman_report.py", line 141, in <module>
    Wkan_results = evaluate_model(Wkan_model, eq_num, eval_seeds, device)
^^^^^^
  File "/Users/jameschen/Documents/Can-KAN-Control/feynman_report.py", line 101, in main

  File "/Users/jameschen/Documents/Can-KAN-Control/feynman_report.py", line 36, in train_model
    if model_type == 'kan':
          ^^^^^^^^^^^^^^^^^^
  File "/Users/jameschen/Documents/Can-KAN-Control/gym_cartlataccel/env.py", line 39, in __init__
    self.min_x, self.max_x = self.find_minmax()
                             ^^^^^^^^^^^^^^^^^^
  File "/Users/jameschen/Documents/Can-KAN-Control/gym_cartlataccel/env.py", line 75, in find_minmax
    out = self.f(torch.tensor(samples))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jameschen/Documents/Can-KAN-Control/gym_cartlataccel/feynman.py", line 706, in <lambda>
    expr = q/(4*pi*eps*y**2)*(4*pi*eps*Ve*d-q*d*y**3/(y**2-d**2)**2)
                                           ^^^^^^^^^^^^^
IndexError: tensors used as indices must be long, int, byte or bool tensors
(kan) jameschen@Jamess-MacBook-Pro-4 Can-KAN-Control % python3 feynman_report.py
equation 115
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 241.4117350578308
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 15.884902715682983
kan
0 reward: -19.184
1 reward: -41.226
2 reward: -69.869
3 reward: -54.119
4 reward: -73.340
5 reward: -26.089
6 reward: -22.285
7 reward: -16.518
8 reward: -20.703
9 reward: -95.237
mlp
0 reward: -11.308
1 reward: -14.494
2 reward: -12.340
3 reward: -13.290
4 reward: -13.327
5 reward: -12.681
6 reward: -12.850
7 reward: -12.893
8 reward: -13.871
9 reward: -15.233
2024-12-05 19:47:54.745 Python[70768:21485803] ApplePersistenceIgnoreState: Existing state will not be touched. New state will be written to /var/folders/nl/
ss4rd5tx78dfyyx_vww_fq040000gn/T/org.python.python.savedState
equation 116
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 4921.969043970108
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 26.34179401397705
kan
0 reward: -15.259
1 reward: -25.305
2 reward: -26.690
3 reward: -23.680
4 reward: -29.417
5 reward: -26.397
6 reward: -24.839
7 reward: -31.778
8 reward: -28.431
9 reward: -30.490
mlp
0 reward: -83.564
1 reward: -26.294
2 reward: -39.159
3 reward: -66.037
4 reward: -98.975
5 reward: -86.168
6 reward: -59.035
7 reward: -115.853
8 reward: -107.424
9 reward: -35.742
equation 117
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 265.89995527267456
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 18.386671781539917
kan
0 reward: -30.937
1 reward: -76.378
2 reward: -106.432
3 reward: -88.215
4 reward: -113.289
5 reward: -49.881
6 reward: -48.885
7 reward: -36.507
8 reward: -62.194
9 reward: -140.382
mlp
0 reward: -27.423
1 reward: -43.742
2 reward: -81.694
3 reward: -60.767
4 reward: -88.250
5 reward: -28.441
6 reward: -17.537
7 reward: -17.772
8 reward: -11.902
9 reward: -115.906
equation 118
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 248.9083788394928
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 18.84362506866455
kan
0 reward: -60.481
1 reward: -128.706
2 reward: -107.003
3 reward: -95.401
4 reward: -62.466
5 reward: -84.597
6 reward: -100.061
7 reward: -62.430
8 reward: -71.861
9 reward: -131.861
mlp
0 reward: -11.840
1 reward: -25.839
2 reward: -21.051
3 reward: -22.121
4 reward: -11.582
5 reward: -20.314
6 reward: -21.912
7 reward: -13.045
8 reward: -14.286
9 reward: -39.102
equation 119
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 253.35641980171204
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 31.000314950942993
kan
0 reward: -70.195
1 reward: -76.020
2 reward: -87.403
3 reward: -75.197
4 reward: -81.746
5 reward: -110.624
6 reward: -82.410
7 reward: -71.679
8 reward: -47.446
9 reward: -138.796
mlp
0 reward: -61.420
1 reward: -29.486
2 reward: -35.630
3 reward: -27.202
4 reward: -35.188
5 reward: -38.568
6 reward: -55.884
7 reward: -32.304
8 reward: -27.019
9 reward: -75.798
equation 120
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 292.73942017555237
10000
20000
30000
40000
50000
60000
70000
80000
90000
100000
Total time: 25.50939393043518
kan
0 reward: -770.557
1 reward: -434.292
2 reward: -398.127
3 reward: -553.095
4 reward: -486.325
5 reward: -580.449
6 reward: -486.450
7 reward: -768.760
8 reward: -730.849
9 reward: -608.177
mlp
0 reward: -813.288
1 reward: -453.503
2 reward: -417.300
3 reward: -581.023
4 reward: -511.188
5 reward: -609.122
6 reward: -509.111
7 reward: -811.439
8 reward: -770.356
9 reward: -637.950

=== DETAILED RESULTS ===

KAN RESULTS:

Equation 1:
Mean: -43.857
Std: 26.403

Equation 2:
Mean: -26.229
Std: 4.403

Equation 3:
Mean: -75.310
Std: 34.358

Equation 4:
Mean: -90.487
Std: 25.329

Equation 5:
Mean: -84.152
Std: 23.559

Equation 6:
Mean: -581.708
Std: 129.623

MLP RESULTS:

Equation 1:
Mean: -13.229
Std: 1.053

Equation 2:
Mean: -71.825
Std: 29.876

Equation 3:
Mean: -49.343
Std: 33.883

Equation 4:
Mean: -20.109
Std: 7.916

Equation 5:
Mean: -41.850
Std: 15.826

Equation 6:
Mean: -611.428
Std: 138.125

=== SUMMARY STATISTICS ===

KAN:
Mean: -150.290
Std: 194.256

MLP:
Mean: -134.631
Std: 214.093
(kan) jameschen@Jamess-MacBook-Pro-4 Can-KAN-Control % tmux capture-pane -p > logs.txt
(kan) jameschen@Jamess-MacBook-Pro-4 Can-KAN-Control % tmux capture-pane -p -S - > logs.txt

